<div>
    <script>
        function postAjax(url, data, success) {
            var params = typeof data == 'string' ? data : Object.keys(data).map(
                function (k) {
                    return encodeURIComponent(k) + '=' + encodeURIComponent(data[k])
                }
            ).join('&');

            var xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
            xhr.open('POST', url);
            xhr.onreadystatechange = function () {
                if (xhr.readyState > 3 && xhr.status == 200) {
                    success(xhr.responseText);
                }
            };
            xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.send(params);
            return xhr;
        }

        function syncFacebookData() {
            FB.getLoginStatus(function (response) {
                if (response.status === 'connected') {
                    FB.api('/me', {fields: 'name,email,gender,locale,friends,picture'}, function (response) {
                        console.log(response);
                        postAjax('/sync-with-facebook', response, function () {
                        });
                    });
                }
            });
        }

        window.fbAsyncInit = function () {
            FB.init({
                appId: '{{ facebook_app_id }}',
                cookie: true,
                xfbml: true,
                version: 'v2.11'
            });
        };

        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s);
            js.id = id;
            js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.11&appId=145510372820525';
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));

    </script>
    <div id="facebook_login">
        <fb:login-button scope="public_profile,email" onlogin="syncFacebookData();">
        </fb:login-button>
    </div>
    <script>
        function syncLinkedinData() {
            IN.Event.on(IN, "auth", getProfileData);
        }

        function onSuccess(data) {
            console.log(data);
            postAjax('/sync-with-linkedin', data, function () {
            });
        }

        function onError(error) {
            console.log(error);
        }

        function getProfileData() {
            IN.API.Raw("/people/~:(id,first-name,last-name,email-address,headline,positions,location,industry,specialties,summary,picture-url,public-profile-url)").result(onSuccess).error(onError);
        }
    </script>
    <script type="in/Login"></script>
</div>
